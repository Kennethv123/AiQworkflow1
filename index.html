<!DOCTYPE html>
<html lang="en">
    <head>  
        <title> page </title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
       
        <link href="https://cdn.plyr.io/3.7.2/plyr.css" rel="stylesheet" />
        <link rel="stylesheet" href="style.css">

        <script src="https://cdn.jsdelivr.net/npm/@millicast/sdk@latest/dist/millicast.umd.js"></script>
        
       <p class="Header"></p>
    </head>
    <body> 
        <div class=MediaBox> 
            <div id="millicasttitle"> millicast demo</div>
            <div class="MainMediaBox" id="MainMediaBox"> 
                <div>No LiVE streaming session is done.</div>
            </div>
            <div class = "SideMediaBox">
                <div class="SidePlayer" id = "SidePlayer1"></div>
                <div class="SidePlayer" id = "SidePlayer2"></div>
                <div class="SidePlayer" id = "SidePlayer3"></div>
            </div>
            <script src="WebRTCPlayer.js"></script>
        </div> 
        
        <div class="MediaBoxHLS">
            <div id = "HLSdemo">HLS demo</div>
            <div class = "MainHlsPlayer">
                <video controls id = "HlsPlayer1">
                    
                    <track kind = "subtitles" src="assets/1. Leo - Netflix - Source English with CC.vtt" srclang="en" label="English" default/>
                    <track kind = "subtitles" src="assets/6. Leo - Netflix - Vietnamese Sub.vtt" srclang="vt" label="Vietnamese" default/>
                   
                    
                </video>
                <script>

                    document.addEventListener("DOMContentLoaded", () => {
                        var HlsVideo = document.getElementById('HlsPlayer1');

                        var HlsVideoSrc = "assets/master.m3u8";
                        const defaultOptions = {};

                        if (Hls.isSupported()) {
                            var hls = new Hls();
                            hls.loadSource(HlsVideoSrc);
                            hls.on(Hls.Events.MANIFEST_PARSED, function(event, data) {
                                const availableQualities = hls.levels.map((l) => l.height)

                                defaultOptions.controls = 
                                [
                                    'play-large', 
                                    'restart', 
                                    'rewind', 
                                    'play', 
                                    'fast-forward', 
                                    'progress',
                                    'current-time', 
                                    'duration', 
                                    'mute', 
                                    'volume', 
                                    'captions', 
                                    'settings', 
                                    'pip', 
                                    'airplay', 
                                    'fullscreen', 
                                ];

                                
                                defaultOptions.quality = {
                                    default: availableQualities[0],
                                    options: availableQualities,
                                    forced: true,
                                    onChange: (e) => updateQuality(e)
                                }
                                
                                const plyr1 = new Plyr(HlsVideo, defaultOptions);
                                
                            });
                            hls.attachMedia(HlsVideo);

                            window.hls = hls;
                        }
                        function updateQuality(newQuality) {
                            window.hls.levels.forEach((level, levelIndex) => {
                                if(level.height === newQuality){
                                    window.hls.currentLevel = levelIndex
                                }
                            })
                        }
                    })
                </script>
            </div>
            <!--
            <div class = "SideHlsBox">
                <div class="SideHlsPlayer">
                    <video id = "HlsPlayer2" height="100%" width="100%" >
                        <script src = "HLSMediaPlayer2.js"></script>
                        <track kind = "subtitles" src="assets/1. Leo - Netflix - Source English with CC.vtt" srclang="en" label="English" default/>
                        <track kind = "subtitles" src="assets/6. Leo - Netflix - Vietnamese Sub.vtt" srclang="vt" label="Vietnamese" default/>
                    </video>
                </div>
                <div class="SideHlsPlayer">
                    <video id = "HlsPlayer3" height="100%" width="100%" >
                            <script src = "HLSMediaPlayer3.js"></script>
                            <track kind = "subtitles" src="assets/1. Leo - Netflix - Source English with CC.vtt" srclang="en" label="English" default/>
                            <track kind = "subtitles" src="assets/6. Leo - Netflix - Vietnamese Sub.vtt" srclang="vt" label="Vietnamese" default/>
                    </video>
                </div>
                <div class="SideHlsPlayer">
                    <video id = "HlsPlayer4" height="100%" width="100%">
                            <script src = "HLSMediaPlayer4.js"></script>
                            <track kind = "subtitles" src="assets/1. Leo - Netflix - Source English with CC.vtt" srclang="en" label="English" default/>
                            <track kind = "subtitles" src="assets/6. Leo - Netflix - Vietnamese Sub.vtt" srclang="vt" label="Vietnamese" default/>
                    </video>
                </div>
            </div>
            -->

            <script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
            <script src="https://cdn.plyr.io/3.7.2/plyr.js"></script>
        </div>
        <footer>
            footer 
        </footer>
    </body>
</html>